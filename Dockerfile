# 1. ابدأ من صورة Playwright الرسمية التي تحتوي على Node.js
# هذا يضمن تثبيت المتصفحات واعتمادياتها بشكل مسبق
FROM playwright/test:v1.44.0

# 2. حدد مجلد العمل داخل "الصندوق" (الحاوية)
WORKDIR /app

# 3. انسخ الملفات التي تحدد الاعتماديات أولاً
# هذا يستفيد من التخزين المؤقت في Docker لتسريع عمليات البناء المستقبلية
COPY package*.json ./

# 4. قم بتثبيت اعتماديات مشروعك (مثل React, Next.js, etc.)
RUN npm install

# 5. الآن انسخ باقي ملفات مشروعك (الكود، الصور، إلخ)
COPY . .

# 6. قم ببناء تطبيق Next.js للإنتاج
RUN npm run build

# 7. أخبر Render أن التطبيق سيعمل على هذا المنفذ
ENV PORT 10000
EXPOSE 10000

# 8. الأمر النهائي لتشغيل الخادم عند بدء التشغيل
CMD ["npm", "start"]
